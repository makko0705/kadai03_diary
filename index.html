<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet">
    <title>æ—¥è¨˜å¸³</title>
</head>

<body>
    <header class="header">
    </header>
    <div id="calendar">
        <h1>Diary</h1>
        <div id="month">
        </div>

        <div class="button_area">
            <p id="btn_save"><img src="img/btn_save.png"></p>
            <p id="btn_clear"><img src="img/btn_clear.png"></p>    
            <p id="btn_happy"><img src="img/btn_happy.png"></p>
            <p id="btn_sad"><img src="img/btn_sad.png"></p>    
            <p id="btn_soso"><img src="img/btn_soso.png"></p>
            <p id="btn_all"><img src="img/btn_all.png"></p>

        </div>
    </div>
    <footer>
    </footer>
    

<script>
 //********************ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ç”Ÿæˆ********************
function daysCreate (start,end) {
    let str = "";
    for(let i=start; i<end; i++) {    
            
        if (i % 7 === 0 ) {//åœŸæ›œæ—¥ 7ã®å€æ•°
            str +=`
            <div class="days"><p class="num blue">${i}</p>
            <textarea id="day_${i}"></textarea>
            <select name="kibun" id="kibun_${i}" class="kibun_area">
            <option value="">æ°—åˆ†</option>
            <option value="happy" class="happy">ğŸ˜</option>
            <option value="sad" class="sad">ğŸ˜¢</option>
            <option value="soso" class="soso">ğŸ˜</option>
            </select>
              
            </div>
            `;
        }
        else if (i % 7 === 1 ) {//æ—¥æ›œæ—¥ 7ã®å€æ•°ï¼‹ï¼‘
            str +=`
            <div class="days"><p class="num red">${i}</p>
            <textarea id="day_${i}"></textarea>
            <select name="kibun" id="kibun_${i}" class="kibun_area">
            <option value="">æ°—åˆ†</option>
            <option value="happy" class="happy">ğŸ˜</option>
            <option value="sad" class="sad">ğŸ˜¢</option>
            <option value="soso" class="soso">ğŸ˜</option>
            </select>
            </div>
             `;
        }
        else {
            str +=`
            <div class="days"><p class="num">${i}</p>
            <textarea id="day_${i}"></textarea>
            <select name="kibun" id="kibun_${i}" class="kibun_area">
            <option value="">æ°—åˆ†</option>
            <option value="happy" class="happy">ğŸ˜</option>
            <option value="sad" class="sad">ğŸ˜¢</option>
            <option value="soso" class="soso">ğŸ˜</option>
            </select>
            </div>
            `;
        }

    }
    return str;
} 
const day = daysCreate(1,32);
$("#month").html(day);

 //********************æ°—åˆ†ã®ç®±ã‚’ç”Ÿæˆ********************
 $('.kibun_area').change(function() {

    var kibun_id = $(this).attr("id");    
    console.log(kibun_id);
    var kibun_val = $(`#${kibun_id}`).val();
    console.log(kibun_val,"ã“ã‚Œã‚’é¸ã³ã¾ã—ãŸ");

    if (kibun_val == "happy") {
        console.log("ã—ã‚ã‚ã›ã§ã™");
        $(`#${kibun_id}`).parent().addClass("happyday");
        $(`#${kibun_id}`).parent().removeClass("days");
    }        
    if (kibun_val == "sad") {
        console.log("ã‹ãªã—ã„ã§ã™");
        $(`#${kibun_id}`).parent().addClass("sadday");
        $(`#${kibun_id}`).parent().removeClass("days");
    }        
    if (kibun_val == "soso") {
        console.log("ã¾ã‚ã¾ã‚ã§ã™");
        $(`#${kibun_id}`).parent().addClass("sosoday");
        $(`#${kibun_id}`).parent().removeClass("days");
    }        

})
//********************ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«æ—¥è¨˜æ©Ÿèƒ½ã‚’ã¤ã‘ã‚‹********************
$("#btn_save").on("click",function(){
    console.log("saveãŒæŠ¼ã•ã‚Œã¾ã—ãŸ");
    for (let i=1; i<32; i++) {
        var diary_num = `day_${i}`;
        var kibun_num = `kibun_${i}`;

        var val = $(`#${diary_num}`).val();
        var kibun_val = $(`#${kibun_num}`).val();

        localStorage.setItem(diary_num,val); //diary_numã« $("#diary_num").val();ã‚’ä¿å­˜
        localStorage.setItem(kibun_num,kibun_val); //kibun_num $("#kibun_num").val();ã‚’ä¿å­˜
    }
});


//********************æ—¥è¨˜ã‚’æ¶ˆã™********************
$("#btn_clear").on("click",function(){
    for(let i=1; i<32; i++) {
        var diary_num = `day_${i}`;
        var kibun_num = `kibun_${i}`;

        var val = $(`#${diary_num}`).val();
        var kibun_val = $(`#${kibun_num}`).val();
        localStorage.removeItem(diary_num);
        localStorage.removeItem(kibun_num);

        if (diary_num) { //ã‚­ãƒ¼ãŒã‚ã‚Œã°valã®ä¸­èº«ã‚’æ¶ˆã™
            $(`#${diary_num}`).val('');
        }
        if (kibun_num) { //ã‚­ãƒ¼ãŒã‚ã‚Œã°valã®ä¸­èº«ã‚’æ¶ˆã™
            $(`#${kibun_num}`).val('');
        }
        // $("#" + diary_num).val('');//ã“ã‚Œã§ã‚‚æ¶ˆã›ã‚‹ã‘ã©å…¨éƒ¨ã‚’æ¶ˆã™æŒ‡ç¤º
        // $("#" + kibun_val).val('');//ã“ã‚Œã§ã‚‚æ¶ˆã›ã‚‹ã‘ã©å…¨éƒ¨ã‚’æ¶ˆã™æŒ‡ç¤º
    }

    location.reload();
    
});

//********************æ—¥è¨˜ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹********************
$("#btn_all").on("click",function(){
    console.log("ã‚ªãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ãŸ");
    $(".happyday").show();
    $(".sadday").show();
    $(".sosoday").show();
    $(".days").show();    
});
$("#btn_happy").on("click",function(){
    console.log("ãƒãƒƒãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ãŸ");
    $(".happyday").show();
    $(".sadday").hide();
    $(".sosoday").hide();
    $(".days").hide();  
});
$("#btn_sad").on("click",function(){
    console.log("ã‹ãªã—ã„ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ãŸ");
    $(".sadday").show();
    $(".happyday").hide();
    $(".sosoday").hide();
    $(".days").hide();
});
$("#btn_soso").on("click",function(){
    console.log("ã¾ã‚ã¾ã‚ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ãŸ");
    $(".sosoday").show();
    $(".happyday").hide();
    $(".sadday").hide();
    $(".days").hide();
});
 //********************ã‚­ãƒ¼ã‚’å–å¾—ã—ã¦å…¥ã£ã¦ã‚‹valueã‚’å„ã‚­ãƒ¼ã«å…¥ã‚Œã‚‹********************
 function keyjudge (start,end) {
    let diary_num = "";
    let kibun_num = "";

    for(let i=start; i<end; i++) {
        diary_num = `day_${i}`;
        kibun_num = `kibun_${i}`;

        //æ—¥è¨˜ã®ã‚­ãƒ¼ãŒã‚ã‚‹ã‹
        if(localStorage.getItem(diary_num)){
            var val = $(`#${diary_num}`).val();
            const diary_content = localStorage.getItem(diary_num);

            $(`#${diary_num}`).val(diary_content);
        }
        //æ°—åˆ†ã®ã‚­ãƒ¼ãŒã‚ã‚‹ã‹
        if(localStorage.getItem(kibun_num)){
            var kibun_val = $(`#${kibun_num}`).val();
            console.log(kibun_val,"ãŸã¶ã‚“ã§ãªã„ã‚“ã§ã™");

            const kibun_content = localStorage.getItem(kibun_num);
            $(`#${kibun_num}`).val(kibun_content);
        }

     }
   
    //return keyname;
}
const key = keyjudge(1,32);

</script>
</body>

</html>